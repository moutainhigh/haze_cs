<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--      
	This file is automatically generated by autoCode(https://git.oschina.net/durcframework/autoCode)
-->
<mapper namespace="com.info.back.dao.IMmanUserLoanDao">
	<resultMap id="queryResultMap" type="com.info.web.pojo.cspojo.MmanUserLoan">
		<result column="id" property="id" jdbcType="VARCHAR"/>
		<!-- 借款用户id -->
		<result column="user_id" property="userId" jdbcType="VARCHAR"/>
		<!-- 借款订单号或借款编号 -->
		<result column="loan_py_id" property="loanPyId" jdbcType="VARCHAR"/>
		<!-- 借款金额，元 -->
		<result column="loan_money" property="loanMoney" jdbcType="DECIMAL"/>
		<!-- 借款利率（如10） -->
		<result column="loan_rate" property="loanRate" jdbcType="VARCHAR"/>
		<!-- 罚息金额 -->
		<result column="loan_penalty" property="loanPenalty" jdbcType="DECIMAL"/>
		<!-- 罚息率(如10，按天算) -->
		<result column="loan_penalty_rate" property="loanPenaltyRate" jdbcType="VARCHAR"/>
		<!-- 放款时间（借款起始时间） -->
		<result column="loan_start_time" property="loanStartTime" jdbcType="TIMESTAMP"/>
		<!-- 应还时间（借款结束时间） -->
		<result column="loan_end_time" property="loanEndTime" jdbcType="TIMESTAMP"/>
		<!-- 借款状态（'4'-逾期,'5'-还款结束） -->
		<result column="loan_status" property="loanStatus" jdbcType="VARCHAR"/>
		<!-- 创建时间 -->
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
		<!-- 更新时间 -->
		<result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
		<!-- 删除标记（'1'-已删除，'0'正常） -->
		<result column="del_flag" property="delFlag" jdbcType="CHAR"/>
		<!-- 这里不用 -->
		<result column="loan_penalty_time" property="loanPenaltyTime" jdbcType="VARCHAR"/>
		<!-- 这里不用 -->
		<result column="loan_sys_status" property="loanSysStatus" jdbcType="VARCHAR"/>
		<!-- 这里不用 -->
		<result column="loan_sys_remark" property="loanSysRemark" jdbcType="VARCHAR"/>
		<!--续期加还款标识-->
		<result column="repay_renewal_mark" property="repayRenewalMark" jdbcType="INTEGER"/>
	</resultMap>
	<!-- 保存,保存不为NULL的字段 -->
	<insert id="saveNotNull" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		<selectKey keyProperty="id" resultType="java.lang.String"
				   order="BEFORE">
			select replace(uuid(),'-','') from dual
		</selectKey>
		INSERT INTO mman_user_loan
		<trim prefix="(" suffix=")" suffixOverrides=",">
			`id`,
			<if test="userId != null">`user_id`,</if>
			<if test="loanPyId != null">`loan_py_id`,</if>
			<if test="loanMoney != null">`loan_money`,</if>
			<if test="loanRate != null">`loan_rate`,</if>
			<if test="loanPenalty != null">`loan_penalty`,</if>
			<if test="loanPenaltyRate != null">`loan_penalty_rate`,</if>
			<if test="loanStartTime != null">`loan_start_time`,</if>
			<if test="loanEndTime != null">`loan_end_time`,</if>
			<if test="loanStatus != null">`loan_status`,</if>
			<if test="createTime != null">`create_time`,</if>
			<if test="updateTime != null">`update_time`,</if>
			<if test="delFlag != null">`del_flag`,</if>
			<if test="loanPenaltyTime != null">`loan_penalty_time`,</if>
			<if test="loanSysStatus != null">`loan_sys_status`,</if>
			<if test="loanSysRemark != null">`loan_sys_remark`,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			#{id,jdbcType=VARCHAR},
			<if test="userId != null">#{userId,jdbcType=VARCHAR},</if>
			<if test="loanPyId != null">#{loanPyId,jdbcType=VARCHAR},</if>
			<if test="loanMoney != null">#{loanMoney,jdbcType=DECIMAL},</if>
			<if test="loanRate != null">#{loanRate,jdbcType=VARCHAR},</if>
			<if test="loanPenalty != null">#{loanPenalty,jdbcType=DECIMAL},</if>
			<if test="loanPenaltyRate != null">#{loanPenaltyRate,jdbcType=VARCHAR},</if>
			<if test="loanStartTime != null">#{loanStartTime,jdbcType=TIMESTAMP},</if>
			<if test="loanEndTime != null">#{loanEndTime,jdbcType=TIMESTAMP},</if>
			<if test="loanStatus != null">#{loanStatus,jdbcType=VARCHAR},</if>
			<if test="createTime != null">#{createTime,jdbcType=TIMESTAMP},</if>
			<if test="updateTime != null">#{updateTime,jdbcType=TIMESTAMP},</if>
			<if test="delFlag != null">#{delFlag,jdbcType=CHAR},</if>
			<if test="loanPenaltyTime != null">#{loanPenaltyTime,jdbcType=VARCHAR},</if>
			<if test="loanSysStatus != null">#{loanSysStatus,jdbcType=VARCHAR},</if>
			<if test="loanSysRemark != null">#{loanSysRemark,jdbcType=VARCHAR},</if>
		</trim>
	</insert>
	<!-- 更新不为NULL的字段 -->
	<update id="updateNotNull" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">UPDATE mman_user_loan
		<set>
			<if test="userId != null">user_id=#{userId,jdbcType=VARCHAR},</if>
			<if test="loanPyId != null">loan_py_id=#{loanPyId,jdbcType=VARCHAR},</if>
			<if test="loanMoney != null">loan_money=#{loanMoney,jdbcType=DECIMAL},</if>
			<if test="loanRate != null">loan_rate=#{loanRate,jdbcType=VARCHAR},</if>
			<if test="loanPenalty != null">loan_penalty=#{loanPenalty,jdbcType=DECIMAL},</if>
			<if test="loanPenaltyRate != null">loan_penalty_rate=#{loanPenaltyRate,jdbcType=VARCHAR},</if>
			<if test="loanStartTime != null">loan_start_time=#{loanStartTime,jdbcType=TIMESTAMP},</if>
			<if test="loanEndTime != null">loan_end_time=#{loanEndTime,jdbcType=TIMESTAMP},</if>
			<if test="loanStatus != null">loan_status=#{loanStatus,jdbcType=VARCHAR},</if>
			<if test="createTime != null">create_time=#{createTime,jdbcType=TIMESTAMP},</if>
			<if test="delFlag != null">del_flag=#{delFlag,jdbcType=CHAR},</if>
			<if test="loanPenaltyTime != null">loan_penalty_time=#{loanPenaltyTime,jdbcType=VARCHAR},</if>
			<if test="loanSysStatus != null">loan_sys_status=#{loanSysStatus,jdbcType=VARCHAR},</if>
			<if test="loanSysRemark != null">loan_sys_remark=#{loanSysRemark,jdbcType=VARCHAR},</if>
			update_time =now()
		</set> WHERE loanPyId = #{loanPyId,jdbcType=VARCHAR}
	</update>
	<!-- 根据主键获取单条记录 -->
	<select id="get" resultMap="queryResultMap" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		SELECT t.id , t.user_id , t.loan_py_id , t.loan_money , t.loan_rate , t.loan_penalty , t.loan_penalty_rate ,
		t.loan_start_time , t.loan_end_time , t.loan_status , t.create_time , t.update_time ,
		t.del_flag , t.loan_penalty_time , t.loan_sys_status , t.loan_sys_remark, repay_renewal_mark
		 FROM mman_user_loan t WHERE id = #{id,jdbcType=VARCHAR}
	</select>
	<!-- 根据主键删除记录 -->
	<delete id="del" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		DELETE FROM mman_user_loan WHERE id = #{id,jdbcType=VARCHAR}
	</delete>

	<select id="findMmanUserLoanList" resultMap="queryResultMap" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		SELECT t.id as id,
		t.user_id as userId,
		t.loan_py_id as loanPyId,
		t.loan_money as loanMoney,
		t.loan_rate as loanRate,
		t.loan_penalty as loanPenalty,
		t.loan_penalty_rate as loanPenaltyRate,
		t.loan_start_time as loanStartTime,
		t.loan_end_time as loanEndTime,
		t.loan_status as loanStatus,
		t.create_time as createTime,
		t.update_time as updateTime,
		t.del_flag as delFlag,
		t.loan_penalty_time as loanPenaltyTime,
		t.loan_sys_status as loanSysStatus,
		t.loan_sys_remark as loanSysRemark
		FROM mman_user_loan t
		WHERE 1=1
		<if test="loanStatus != null and loanStatus !=''">
			and loan_status = #{loanStatus}
		</if>
		<if test="delFlag != null and delFlag !=''">
			and del_flag = #{delFlag}
		</if>
		<if test="id != null and id !=''">
			and id = #{id}
		</if>
	</select>


	<select id="findMmanUserLoanList2" resultMap="queryResultMap" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		SELECT t.id as id,
		t.user_id as userId,
		t.loan_py_id as loanPyId,
		t.loan_money as loanMoney,
		t.loan_rate as loanRate,
		t.loan_penalty as loanPenalty,
		t.loan_penalty_rate as loanPenaltyRate,
		t.loan_start_time as loanStartTime,
		t.loan_end_time as loanEndTime,
		t.loan_status as loanStatus,
		t.create_time as createTime,
		t.update_time as updateTime,
		t.del_flag as delFlag,
		t.loan_penalty_time as loanPenaltyTime,
		t.loan_sys_status as loanSysStatus,
		t.loan_sys_remark as loanSysRemark
		FROM mman_user_loan t
		WHERE 1=1
		<if test="loanStatus != null and loanStatus !=''">
			and loan_status = #{loanStatus}
		</if>
		<if test="delFlag != null and delFlag !=''">
			and del_flag = #{delFlag}
		</if>
		<if test="createTime !=null and createTime !=''">
			<![CDATA[	and DATE_FORMAT(t.`create_time`,'%Y-%m-%d') < DATE_FORMAT(#{createTime},'%Y-%m-%d') ]]>
		</if>
	</select>

	<!-- 更新不为NULL的字段 -->
	<update id="updateMmanUserLoan" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">
		UPDATE mman_user_loan
		<set>
			<if test="userId != null and userId !=''">user_id=#{userId},</if>
			<if test="loanPyId != null and loanPyId !='' ">loan_py_id=#{loanPyId},</if>
			<if test="loanMoney != null">loan_money=#{loanMoney},</if>
			<if test="loanRate != null and loanRate !=''">loan_rate=#{loanRate},</if>
			<if test="loanPenalty != null">loan_penalty=#{loanPenalty},</if>
			<if test="loanPenaltyRate != null and loanPenaltyRate!=''">loan_penalty_rate=#{loanPenaltyRate},</if>
			<if test="loanStartTime != null">loan_start_time=#{loanStartTime},</if>
			<if test="loanEndTime != null">loan_end_time=#{loanEndTime},</if>
			<if test="loanStatus != null and loanStatus!=''">loan_status=#{loanStatus},</if>
			<if test="createTime != null">create_time=#{createTime},</if>
			<if test="delFlag != null and delFlag!=''">del_flag=#{delFlag},</if>
			<if test="loanPenaltyTime != null">loan_penalty_time=#{loanPenaltyTime},</if>
			<if test="loanSysStatus != null and loanSysStatus!=''">loan_sys_status=#{loanSysStatus},</if>
			<if test="loanSysRemark != null">loan_sys_remark=#{loanSysRemark},</if>
			update_time=now()
		</set>
		WHERE id = #{id}
	</update>

	<update id="updatePaymoney" parameterType="com.info.web.pojo.cspojo.MmanUserLoan">

		UPDATE mman_user_loan

		<set>
			<if test="loanPenalty != null">loan_penalty=#{loanPenalty},</if>
			update_time=now()

		</set>
		WHERE id = #{id}
	</update>

</mapper>
